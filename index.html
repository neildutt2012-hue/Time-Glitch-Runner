<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>City Chaos Runner</title>
<style>
  body { margin:0; overflow:hidden; background:#000; font-family:monospace;}
  #scoreBox { position:absolute; top:10px; left:10px; color:#0ff; font-size:22px; }
  canvas { display:block; }
</style>
</head>
<body>
<div id="scoreBox">Score: <span id="score">0</span></div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let W = canvas.width = window.innerWidth;
let H = canvas.height = window.innerHeight;

window.onresize = () => {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
};

// Player
let player = {
  x: 120,
  y: H - 180,
  w: 60,
  h: 80,
  vy: 0,
  gravity: 1,
  jumping: false,
  sliding: false,
  slideTime: 0
};

// Obstacles
let obstacles = [];
let speed = 10;
let score = 0;
let gameOver = false;

function randomObstacle() {
  let type = Math.floor(Math.random() * 3);

  if (type === 0) {
    // Tall obstacle
    obstacles.push({
      x: W + 50,
      y: H - 180,
      w: 60,
      h: 80,
      color: "#f0f"
    });
  }

  if (type === 1) {
    // Low obstacle (slide under)
    obstacles.push({
      x: W + 50,
      y: H - 140,
      w: 90,
      h: 40,
      color: "#ff0"
    });
  }

  if (type === 2) {
    // Flying drone
    obstacles.push({
      x: W + 50,
      y: H - 300,
      w: 70,
      h: 50,
      color: "#0f0"
    });
  }
}

setInterval(randomObstacle, 1200);

// Reset
function reset() {
  obstacles = [];
  speed = 10;
  score = 0;
  player.y = H - 180;
  player.vy = 0;
  gameOver = false;
}

// Update
function update() {
  if (gameOver) return;

  // Jump physics
  player.vy += player.gravity;
  player.y += player.vy;

  // Ground collision
  if (player.y + player.h >= H - 100) {
    player.y = H - 100 - player.h;
    player.vy = 0;
    player.jumping = false;
  }

  // Sliding
  if (player.sliding) {
    player.h = 40;
    player.slideTime--;

    if (player.slideTime <= 0) {
      player.h = 80;
      player.sliding = false;
    }
  }

  // Move obstacles
  for (let o of obstacles) {
    o.x -= speed;
  }

  // Remove old ones
  obstacles = obstacles.filter(o => o.x + o.w > 0);

  // Collision
  for (let o of obstacles) {
    if (player.x < o.x + o.w &&
        player.x + player.w > o.x &&
        player.y < o.y + o.h &&
        player.y + player.h > o.y) {
      alert("GAME OVER! Score: " + Math.floor(score));
      reset();
      return;
    }
  }

  // Difficulty increase
  speed += 0.002;
  score += 0.1;
  document.getElementById("score").textContent = Math.floor(score);
}

// Draw everything
function draw() {
  ctx.clearRect(0, 0, W, H);

  // Ground
  ctx.fillStyle = "#033";
  ctx.fillRect(0, H - 100, W, 5);

  // Player
  ctx.fillStyle = "#0ff";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // Obstacles
  for (let o of obstacles) {
    ctx.fillStyle = o.color;
    ctx.fillRect(o.x, o.y, o.w, o.h);
  }
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();

// Controls
window.addEventListener("keydown", e => {
  if (e.code === "Space" && !player.jumping) {
    player.vy = -20;
    player.jumping = true;
  }
  if (e.code === "ArrowDown" && !player.sliding && !player.jumping) {
    player.sliding = true;
    player.slideTime = 20;
  }
});
</script>
</body>
</html>
